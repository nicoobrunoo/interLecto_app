<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>InterLecto — Intercambio de libros</title>
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="InterLecto: app tipo Tinder para intercambiar libros. Swipe, matches y gestión de tus libros.">
  <link rel="stylesheet" href="./assets/css/app.css">

  <!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#22c55e">

<!-- Para iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="InterLecto">
<link rel="apple-touch-icon" href="./assets/img/logo.png">

</head>
<body>
<div class="phone-wrap">
  <div class="app" id="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo-wrap">
          <img id="brandLogo" src="./assets/img/logo.png" alt="Logo InterLecto">
        </div>
        <span><b>Inter</b>Lecto<small>beta</small></span>
      </div>
      <button class="menu-btn" id="openDrawerBtn" aria-label="Abrir menú" aria-controls="drawer" aria-expanded="false">
        <svg viewBox="0 0 24 24"><path d="M3 6h18v2H3zM3 11h18v2H3zM3 16h18v2H3z"/></svg>
      </button>
    </header>

    <main class="views">
      <!-- Descubrir -->
      <section id="discover" class="view active" aria-labelledby="discoverTitle">
        <h2 id="discoverTitle" class="visually-hidden" style="position:absolute;left:-9999px;">Descubrir</h2>
        <div class="stack" id="cardStack">
          <div class="empty" id="emptyState">
            <h2>¡No hay más libros!</h2>
            <p>Publicá el tuyo o reiniciá el mazo.</p>
            <div style="display:flex;gap:8px;justify-content:center">
              <button class="btn" onclick="switchTab('publish')">Publicar</button>
              <button class="btn" onclick="resetDeck()">Reiniciar</button>
            </div>
          </div>
          <!-- Controles flotantes -->
          <div class="controls" aria-label="Controles de swipe">
            <button class="cbtn nope" id="btnNope" aria-label="Descartar" title="Nope (←)">
              <svg viewBox="0 0 24 24"><path d="M18.3 5.7a1 1 0 0 0-1.4 0L12 10.6 7.1 5.7A1 1 0 0 0 5.7 7.1L10.6 12l-4.9 4.9a1 1 0 0 0 1.4 1.4L12 13.4l4.9 4.9a1 1 0 0 0 1.4-1.4L13.4 12l4.9-4.9a1 1 0 0 0 0-1.4Z"/></svg>
            </button>
            <button class="cbtn super" id="btnSuper" aria-label="Super Like" title="Super Like (↑)">
              <svg viewBox="0 0 24 24"><path d="M12 2 9.9 8.1 4 10.1l6 2 2 6 2-6 6-2-6-2z"/></svg>
            </button>
            <button class="cbtn like" id="btnLike" aria-label="Me gusta" title="Like (→)">
              <svg viewBox="0 0 24 24"><path d="M12 21.3 10.6 20C5.4 15.4 2 12.3 2 8.5 2 6.1 3.6 4.5 6 4.5c1.5 0 3 .99 4 2.4 1-1.4 2.5-2.4 4-2.4 2.4 0 4 1.6 4 4 0 3.8-3.4 6.9-8.6 11.5z"/></svg>
            </button>
          </div>
        </div>
      </section>

      <!-- Matches -->
      <section id="matches" class="view" aria-labelledby="matchesTitle">
        <h2 id="matchesTitle">Coincidencias</h2>
        <p class="helper">Cuando el dueño del libro también esté interesado en el tuyo, verás el match acá.</p>
        <div class="matches" id="matchesList"></div>
      </section>

      <!-- Mis libros -->
      <section id="mine" class="view" aria-labelledby="mineTitle">
        <h2 id="mineTitle">Mis libros</h2>
        <div id="myBooks" class="mylist"></div>
      </section>

      <!-- Likes (Premium) -->
      <section id="likes" class="view" aria-labelledby="likesTitle" style="display:none">
        <h2 id="likesTitle">Likes</h2>
        <p class="helper">Usuarios que te dieron like (Premium).</p>
        <div id="likesList" class="mylist"></div>
      </section>

      <!-- Publicar -->
      <section id="publish" class="view" aria-labelledby="publishTitle">
        <h2 id="publishTitle">Publicar libro</h2>

        <form id="publishForm">
          <div class="grid">
            <div class="full">
              <label for="pTitle">Título</label>
              <input id="pTitle" required placeholder="Ej: El Principito">
            </div>
            <div>
              <label for="pAuthor">Autor/a</label>
              <input id="pAuthor" required placeholder="Ej: Saint-Exupéry">
            </div>
            <div>
              <label for="pOwner">Tu nombre</label>
              <input id="pOwner" required placeholder="Ej: Germán">
            </div>
            <div class="full">
              <label for="pContact">Contacto (email o WhatsApp)</label>
              <input id="pContact" required placeholder="Ej: german@email.com o +54...">
            </div>

            <!-- Imagen -->
            <div class="full">
              <label for="pImage">Imagen de portada (opcional)</label>
              <input id="pImage" type="file" accept="image/*">
              <img id="pPreview" alt="Preview" style="margin-top:8px;max-width:100%;border-radius:10px;border:1px solid #e5e7eb;display:block;" hidden>
            </div>

            <div class="full">
              <label for="pPrefs">Qué buscás a cambio</label>
              <input id="pPrefs" placeholder="Ej: Fantasía, novelas contemporáneas">
            </div>
            <div>
              <label for="pCondition">Estado</label>
              <select id="pCondition">
                <option>Como nuevo</option><option>Muy bueno</option><option>Bueno</option><option>Con señales de uso</option>
              </select>
            </div>
            <div>
              <label for="pCity">Ciudad / Zona</label>
              <input id="pCity" placeholder="Ej: Pilar, Buenos Aires">
            </div>
            <div class="full">
              <label for="pNotes">Notas</label>
              <textarea id="pNotes" placeholder="Detalles relevantes (edición, idioma, etc.)"></textarea>
            </div>
          </div>
          <div style="display:flex; gap:8px; margin-top:12px;">
            <button type="submit" class="btn primary">Agregar a mis libros</button>
            <button type="button" class="btn ghost" id="clearAll">Borrar todos</button>
          </div>
        </form>
        <p class="helper">Tus libros se guardan localmente (LocalStorage). Podés verlos y gestionarlos en <strong>Mis libros</strong>.</p>
      </section>
    </main>

    <!-- Tabbar -->
    <nav class="tabbar" aria-label="Navegación principal">
      <div class="tabbar-inner">
        <button class="tab active" data-tab="discover" aria-label="Descubrir">
          <svg viewBox="0 0 24 24"><path d="M3 11l9-8 9 8v9a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1z"/></svg>
          <span>Descubrir</span>
        </button>
        <button class="tab" data-tab="matches" aria-label="Matches">
          <svg viewBox="0 0 24 24"><path d="M12 21.35 10.55 20.03C5.4 15.36 2 12.28 2 8.5 2 6.14 3.64 4.5 6 4.5c1.54 0 3.04.99 4 2.44C11.96 5.49 13.46 4.5 15 4.5 17.36 4.5 19 6.14 19 8.5c0 3.78-3.4 6.86-8.55 11.54z"/></svg>
          <span>Matches</span>
        </button>
        <button class="tab" data-tab="mine" aria-label="Mis libros">
          <svg viewBox="0 0 24 24"><path d="M6 2h9a3 3 0 0 1 3 3v15a2 2 0 0 1-2 2H6a4 4 0 0 1-4-4V6a4 4 0 0 1 4-4zm0 2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10V5a1 1 0 0 0-1-1z"/></svg>
          <span>Mis libros</span>
        </button>
        <button class="tab" data-tab="publish" aria-label="Publicar">
          <svg viewBox="0 0 24 24"><path d="M12 5v6H6v2h6v6h2v-6h6v-2h-6V5z"/></svg>
          <span>Publicar</span>
        </button>
      </div>
    </nav>

    <!-- Drawer -->
    <div class="drawer-backdrop" id="drawerBackdrop"></div>
    <aside class="drawer" id="drawer" aria-hidden="true">
      <header>
        <div class="title">Menú</div>
        <button class="close" id="closeDrawerBtn" aria-label="Cerrar menú">
          <svg viewBox="0 0 24 24"><path d="M18.3 5.7a1 1 0 0 0-1.4 0L12 10.6 7.1 5.7A1 1 0 1 0 5.7 7.1L10.6 12l-4.9 4.9a1 1 0 1 0 1.4 1.4L12 13.4l4.9 4.9a1 1 0 0 0 1.4-1.4L13.4 12l4.9-4.9a1 1 0 0 0 0-1.4Z"/></svg>
        </button>
      </header>
      <div class="menu">
        <button class="item" id="goProfile">
          <svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.33 0-8 2.17-8 5v1h16v-1c0-2.83-3.67-5-8-5Z"/></svg>
          <div>
            <div class="text">Perfil</div>
            <div class="sub">Tu cuenta e identidad</div>
          </div>
        </button>

        <button class="item" id="goSettings">
          <svg viewBox="0 0 24 24"><path d="M19.14 12.94a7.07 7.07 0 0 0 0-1.88l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96a7.16 7.16 0  0 0-1.63-.95l-.36-2.54a.5.5 0 0 0-.5-.43h-3.84a.5.5 0  0 0-.5.43l-.36 2.54a7.16 7.16 0  0 0-1.63.95l-2.39-.96a.5.5 0  0 0-.6.22L2.71 8.84a.5.5 0 0 0 .12.64l2.03 1.58a7.07 7.07 0  0 0 0 1.88L2.83 15.1a.5.5 0  0 0-.12.64l1.92 3.32a.5.5 0  0 0 .6.22l2.39-.96c.5.39 1.05.71 1.63.95l.36 2.54a.5.5 0  0 0 .5.43h3.84a.5.5 0  0 0 .5-.43l.36-2.54c.58-.24 1.13-.56 1.63-.95l2.39.96a.5.5 0  0 0 .6-.22l1.92-3.32a.5.5 0  0 0-.12-.64ZM12 15.5A3.5 3.5 0 1 1 15.5 12 3.5 3.5 0 0 1 12 15.5Z"/></svg>
          <div>
            <div class="text">Ajustes</div>
            <div class="sub">Notificaciones, privacidad</div>
          </div>
        </button>

        <!-- Likes (Premium) -->
        <button class="item" id="goLikes" title="Solo con Premium">
          <svg viewBox="0 0 24 24"><path d="M12 21.35 10.55 20.03C5.4 15.36 2 12.28 2 8.5 2 6.14 3.64 4.5 6 4.5c1.54 0 3.04.99 4 2.44C11.96 5.49 13.46 4.5 15 4.5c2.36 0 4 1.64 4 4 0 3.78-3.4 6.86-8.55 11.54z"/></svg>
          <div>
            <div class="text">Ver likes</div>
            <div class="sub">Descubrí quién te dio like</div>
          </div>
        </button>

        <div class="item premium">
          <svg viewBox="0 0 24 24"><path d="M12 2 9.6 8H4l4.5 3.27L6.8 17 12 13.73 17.2 17l-1.7-5.73L20 8h-5.6z"/></svg>
          <div style="flex:1">
            <div class="text">Premium</div>
            <div class="sub">Desbloqueá funciones extra (ver quién te dio like)</div>
            <button class="cta" id="goPremium">Activar Premium</button>
            <!-- NUEVO: botón rojo para cancelar (lo muestra el JS si premium=on) -->
            <button class="cta danger" id="cancelPremium" style="display:none; margin-left:8px;">Cancelar suscripción</button>
          </div>
        </div>
      </div>
      <button class="logout" id="logoutBtn">Cerrar sesión</button>
    </aside>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast" role="status" aria-live="polite"></div>

<!-- Match Modal -->
<div class="modal" id="matchModal" aria-hidden="true">
  <div class="box">
    <h3>¡Es un match! 🎉</h3>
    <p id="matchText" style="color:#334155">Pueden coordinar desde <strong>Matches</strong>.</p>
    <div style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end">
      <button class="btn" onclick="closeMatch()">Cerrar</button>
      <button class="btn primary" onclick="switchTab('matches'); closeMatch();">Ver Matches</button>
    </div>
  </div>
</div>

<!-- Premium Modal -->
<div class="modal" id="premiumModal" aria-hidden="true">
  <div class="box">
    <h3>InterLecto Premium ✨</h3>
    <p style="color:#334155">
      • Ver quién te dio like para matchear al instante.<br>
      • Publicá hasta <strong>3 libros</strong> a la vez.
    </p>
    <div style="display:flex; gap:8px; margin-top:12px; justify-content:flex-end">
      <button class="btn" id="premiumNo"  onclick="closePremium()">Ahora no</button>
      <button class="btn primary" id="premiumYes">Activar Premium</button>
    </div>
  </div>
</div>

<script type="module" src="./js/main.js"></script>
</body>
</html>
